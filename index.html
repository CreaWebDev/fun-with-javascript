<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" type="text/css" href="scss\main.css">
    <link href="https://fonts.googleapis.com/css?family=Mansalva&display=swap" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <title>Main</title>
</head>
<body style="margin-top: 100px; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color:mistyrose; color: darkred;">
    <h2 style="text-align: center;">
        Fun with JavaScript, SVG & Styling
    </h2>
    <div id="black-fri" style="text-align: center; margin-top: 50px; display: flex; flex-direction: column; padding: 0 80px;">
        <h3 style="color: darkslategrey;">Countdown clocks for New Years Eve!</h3><br>
        <p style="color: gray">[ Watch when the minutes change ]</p>
        <canvas></canvas>
        <div id="countdown--clock">
            <div class="countdownbox test" id="day">
                <section class="days">
                    <h2>Dage</h2>
                    <div id="countdown__days"></div>
                    <svg>
                        <circle class="base-circle" r="50" cx="75" cy="75"></circle>  
                        <circle id="circle-days" r="50" cx="75" cy="75" class="progress"></circle>
                    </svg>
                </section>
             </div>
            <div class="countdownbox test" id="hour">
                <section class="hours">
                    <h2>Timer</h2>
                    <div id="countdown__hours"></div>
                     <svg>
                        <circle class="base-circle" r="50" cx="75" cy="75"></circle>  
                         <circle id="circle-hours" r="50" cx="75" cy="75" class="progress"></circle>
                    </svg>
                </section>
            </div>    
            <div class="countdownbox test" id="minute">
            <section class="minutes">
                <h2>Minutter</h2>
                <div id="countdown__minutes"></div>
                <svg>
                    <circle class="base-circle" r="50" cx="75" cy="75" ></circle>  
                    <circle id="circle-min" r="50" cx="75" cy="75" class="progress"></circle>
                </svg>
            </section>
            </div>
            <div class="countdownbox test" id="seco">
            <section class="seconds">
                    <h2>Sekunder</h2>
                    <div id="countdown__seconds"></div>
                    <svg>
                        <circle class="base-circle" r="50" cx="75" cy="75"></circle>  
                        <circle id="circle-sec" r="50" cx="75" cy="75" class="progress"></circle>
                    </svg>
                </section>
            </div>
        </div>
        <div id="testing"></div>
        <p class="site-footer__headline">
            Copyright 2020 - Pia Roel JÃ¸rgensen
        </p>
    </div>

    <script>
        $( ".countdownbox" ).hover(
        function() {
        var c = document.querySelector('canvas'),
            ctx = c.getContext('2d'),
            width = c.width = window.innerWidth,
            height = c.height = window.innerHeight,

            n_stars = 150, //num of stars
            stars = [], //array to store generated stars
            twinkleFactor = .4, //how much stars 'twinkle'
            maxStarRadius = 3,

            fw1, fw2, //firework objects
            minStrength = 1.5, //lowest firework power
            maxStrength = 7, //highest firework power
            minTrails = 7, //min particles
            maxTrails = 30, //max particles
            particleRadius = 2,
            trailLength = 15, //particle trail length
            delay = .5, // number of LIFEs between explosions

            LIFE = 150, //life time of firework

            g = 5e-2, //strength of gravity
            D = 1e-3; //strength of drag (air resistance)

        // Particle Class
        var Particle = function(x, y, vx, vy, ax, ay, colour) {
            this.x = x;
            this.y = y;
            this.vx = vx;
            this.vy = vy;
            this.ax = ax;
            this.ay = ay;
            this.life = LIFE; //only here for opacity in .draw() method
            this.path = [];
            this.colour = colour;
            this.r = particleRadius;

            this.update = function() {
                this.life--;

                // add point to path but if full, remove a point first
                if (this.path.length >= trailLength) this.path.shift();
                this.path.push([this.x, this.y])

                // update speed n position n stuff
                this.vy += this.ay;
                this.vx += this.ax;
                this.x += this.vx;
                this.y += this.vy;
            }

            this.draw = function() {
                var opacity = ~~(this.life * 100 / LIFE) / 100;

                // tail      
                ctx.fillStyle = 'rgba(' + this.colour + (opacity * 0.4) + ')';
                if (this.life > LIFE * 0.95) ctx.fillStyle = '#fff';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(this.x - this.r, this.y);
                var i = this.path.length - 1;
                ctx.lineTo(this.path[0][0], this.path[0][1]);
                ctx.lineTo(this.x + this.r, this.y);
                ctx.closePath();
                ctx.fill();

                // main dot
                ctx.fillStyle = 'rgba(' + this.colour + opacity + ')';
                if (this.life > LIFE * 0.95) ctx.fillStyle = '#fff';
                ctx.beginPath();
                ctx.arc(~~this.x, ~~this.y, this.r, 0, Math.PI * 2);
                ctx.fill();
                ctx.closePath();
            }
        }

        // Firework class
        var Firework = function() {
            this.x = width * (Math.random() * 0.8 + 0.1); // from 0.1-0.9 widths
            this.y = height * (Math.random() * 0.8 + 0.1); // from 0.1-0.9 heights
            this.strength = Math.random() * (maxStrength - minStrength) + minStrength;
            this.colour = ~~(Math.random() * 255) + ',' +
                ~~(Math.random() * 255) + ',' +
                ~~(Math.random() * 255) + ',';
            this.life = 0;
            this.particles = (function(x, y, strength, colour) {
                var p = [];

                var n = ~~(Math.random() * (maxTrails - minTrails)) + minTrails;
                var ay = g;
                for (var i = n; i--;) {
                    var ax = D;
                    var angle = i * Math.PI * 2 / n;
                    if (angle < Math.PI) ax *= -1;
                    var vx = strength * Math.sin(angle);
                    var vy = strength * Math.cos(angle);
                    p.push(new Particle(x, y, vx, vy, ax, ay, colour));
                }

                return p;
            })(this.x, this.y, this.strength, this.colour);

            this.update = function() {
                this.life++;
                if (this.life < 0) return; //allows life to be delayed
                for (var i = this.particles.length; i--;) {
                    this.particles[i].update();
                    this.particles[i].draw();
                }
            }
        };

        var Star = function() {
            this.x = Math.random() * width;
            this.y = Math.random() * height;
            this.r = Math.random() * maxStarRadius;
            this.b = ~~(Math.random() * 100) / 100;
        }

        Star.prototype.draw = function() {
            this.b += twinkleFactor * (Math.random() - .5);
            ctx.fillStyle = 'rgba(255,255,255,' + this.b + ')';
            ctx.beginPath();
            ctx.arc(~~this.x, ~~this.y, this.r, 0, Math.PI * 2);
            ctx.fill();
            ctx.closePath();
        }

        function createStars() {
            for (var i = n_stars; i--;) stars.push(new Star);
        }

        function main() {
            ctx.fillStyle = 'mistyrose';
            ctx.fillRect(0, 0, width, height);

            // for (var i = n_stars; i--;) stars[i].draw();

            fw1.update();
            fw2.update();

            if (fw1.life == LIFE * delay) fw2 = new Firework;
            if (fw2.life == LIFE * delay) fw1 = new Firework;

            window.requestAnimationFrame(main);
        }

        function init() {
            fw1 = new Firework;
            fw2 = new Firework;
            fw2.life = -LIFE * delay;
            // createStars();
            main();
        }
        init();

    });
</script>
<script>
    // Set the countdown date to Black Friday
    var newYears = '01. januar 2021';
        var date = newYears;
        
        // Get the ID element for each countdown text
        var countdownDaysEl = document.getElementById('countdown__days');
        var countdownHoursEl = document.getElementById('countdown__hours');
        var countdownMinEl = document.getElementById('countdown__minutes');
        var countdownSecEl = document.getElementById('countdown__seconds');

        
        // Get the ID element for each circle progress
        var circleSec = document.getElementById('circle-sec');
        var circleMin = document.getElementById('circle-min');
        var circleHours = document.getElementById('circle-hours');
        var circleDays = document.getElementById('circle-days');
        
        // Define total time in sec/min/hours/days, with _ has digits
        var wholeTime = Date.parse(newYears) - Date.parse(new Date());
        var countdownDays_ = (((wholeTime/1000)/60)/60) / 24;
        var countdownDays = Math.floor(countdownDays_);
        var countdownHours_ = (countdownDays_ - countdownDays) * 24;
        var countdownHours = Math.floor(countdownHours_);
        var countdownMinutes_ = (countdownHours_ - countdownHours) * 60;
        var countdownMinutes = Math.floor(countdownMinutes_);
        var countdownSeconds_ = (countdownMinutes_ - countdownMinutes) * 60;
        var countdownSeconds = Math.floor(countdownSeconds_);

        // Set the content for time
        countdownDaysEl.textContent = Math.floor(countdownDays);
        countdownHoursEl.textContent = Math.floor(countdownHours);
        countdownMinEl.textContent = Math.floor(countdownMinutes);
        countdownSecEl.textContent = Math.floor(countdownSeconds);

        // calculate the circumference for circle
        let length = Math.PI * 2 * 50; // 50 is the radius of the circle
        // set the default circle to the calculated length
        circleDays.style.strokeDasharray = length;
        circleHours.style.strokeDasharray = length;
        circleMin.style.strokeDasharray = length;
        circleSec.style.strokeDasharray = length;

        
        // function for circle days
        updateCircleDays(countdownDays);
        function updateCircleDays(value) {
            var offset = - length - (length * value / (45));
            circleDays.style.strokeDashoffset = offset;
        } 
        
        // function for circle hours
        updateCircleHours(countdownHours);
        function updateCircleHours(value) {
            var offset = - length - (length * value / (24));
            circleHours.style.strokeDashoffset = offset;
        } 
        
        updateCircleMin(countdownMinutes);
        // function for circle minutes
        function updateCircleMin(value) {
            var offset = - length - (length * value / (60));
            circleMin.style.strokeDashoffset = offset;
        } 
        
        updateCircle(countdownSeconds);
        // function for circle seconds
        function updateCircle(value) {
            var offset = - length - (length * value / (60));
            circleSec.style.strokeDashoffset = offset;
        }

        // Code for the fireworks
        // place an interval for each second in Jquery
        // if statements inside controls the change in minutes/hours/days progress
        $(document).ready(function() {

            // countdown for seconds
            setInterval(function() {
                // the remaining time
                let remainSeconds = Date.parse(new Date()) + countdownSeconds; 
                // make countdown from 60 to 0
                countdownSeconds = --countdownSeconds <= -1 ? 59 : countdownSeconds;
                // set the above to show as content in the text element for seconds
                countdownSecEl.textContent = countdownSeconds;
                
                    if (countdownSeconds === 59) {
                    countdownMinutes = --countdownMinutes <= -1 ? 59 : countdownMinutes;
                
                    let remainMinutes = Date.parse(new Date()) + countdownMinutes; 
                    countdownMinEl.textContent = countdownMinutes;

                    minutesLeft = Math.round(remainMinutes - Date.parse(new Date()));
                    updateCircleMin(minutesLeft);

                        if (countdownMinutes === 0) {
                        countdownHours = --countdownHours <= 0 ? 24 : countdownHours;
                        // set the above to show as content in the text element for minutes
                        countdownHoursEl.textContent = Math.floor(countdownHours);
                        

                        let remainHours = Date.parse(new Date()) + countdownHours; 
                        // update the circle
                        hoursLeft = Math.round(remainHours - Date.parse(new Date()));
                        updateCircleHours(hoursLeft);

                            if ( countdownHours === 24) {
                            countdownDays = --countdownDays <= 0 ? 45 : countdownDays;
                            // set the above to show as content in the text element for minutes
                            countdownDaysEl.textContent = Math.floor(countdownDays);
                
                            let remainDays = Date.parse(new Date()) + countdownDays; 
                            // update the circle
                            DaysLeft = Math.round(remainDays - Date.parse(new Date()));
                            updateCircleDays(daysLeft);

                            } 
                        }
                    }

                updateCircle(wholeTime);
                secondsLeft = Math.round(remainSeconds - Date.parse(new Date()));
                updateCircle(secondsLeft);

            }, 1000);

        });


        
    </script>

    
</body>
</html>